tinymce.PluginManager.requireLangPack("bootstrap"),tinymce.PluginManager.add("bootstrap",function(t,e){function a(a,r,c,l){function b(){var t="",n=tinymce.activeEditor.getParam("language");return n||(n="en_EN"),t+='<input type="hidden" name="bs-code" id="bs-code" />',t+='<iframe src="'+e+"/"+a+"?language="+n+"&images_path="+imagesPath+"&bootstrap_css_path="+bootstrapCssPath+"&"+g+"&"+(new Date).getTime()+'"></iframe>'}var p=s(),g="";$(p).hasClass("active")&&($(p).hasClass("btn")?g=i(p,"bsBtn"):$(p).hasClass("glyphicon")?g=i(p,"bsIcon"):$(p).is("img")?g=i(p,"bsImage"):$(p).hasClass("table")?g=i(p,"bsTable"):$(p).hasClass("breadcrumb")?g=i(p,"bsBreadcrumb"):$(p).hasClass("pagination")?g=i(p,"bsPagination"):$(p).hasClass("pager")?g=i(p,"bsPager"):$(p).hasClass("label")?g=i(p,"bsLabel"):$(p).hasClass("badge")?g=i(p,"bsBadge"):$(p).hasClass("alert")?g=i(p,"bsAlert"):$(p).hasClass("panel")&&(g=i(p,"bsPanel")));var m=d;$(window).width()<885&&(m=.9*$(window).width()),$(window).height()>c&&(c=.9*$(window).height()-90),win=t.windowManager.open({title:r,width:m,height:c,html:b(),buttons:[{text:"OK",subtype:"primary",onclick:function(t){o(t,l),this.parent().parent().close()}},{text:"Cancel",onclick:function(){this.parent().parent().close()}}]}),$(".mce-floatpanel").find(".mce-widget.mce-abs-layout-item.mce-first").css({left:"auto",right:"82px"}),$(".mce-floatpanel").find(".mce-widget.mce-last.mce-abs-layout-item").css({left:"auto",right:"10px"}),$(window).on("resize",function(){n()})}function n(){var t=d;t=$(window).width()>d?d:.9*$(window).width(),$(".mce-floatpanel").width(t).css("left",($(window).width()-t)/2),$(".mce-floatpanel").find(".mce-container-body, .mce-foot, .mce-abs-layout").width(t),768>t?$("iframe").contents().find(".container").addClass("container-xs"):$("iframe").contents().find(".container").removeClass("container-xs")}function s(){var e=t.selection.getNode();if(!$(e).hasClass("active")||$(e).closest("ol.breadcrumb").length>0||$(e).closest("ul.pagination").length>0||$(e).closest("ul.pager").length>0||$(e).closest("div.alert").length>0)for(var a=[".table",".breadcrumb",".pagination",".pager",".alert",".panel"],n=!1,s=0;s<a.length;s++)$(e).closest(a[s]).length>0&&n===!1&&(e=$(e).closest(a[s]),n=!0);return e}function o(e,a){var n=r(document.getElementById("bs-code").value)+"<p></p>",o=s();if($(o).hasClass("active")){$(o).after(n);var i={bsBtn:"btn",bsIcon:"glyphicon",bsImage:"img",bsTable:"table",bsBreadcrumb:"breadcrumb",bsPagination:"pagination",bsPager:"pager",bsLabel:"label",bsBadge:"badge",bsAlert:"alert",bsPanel:"panel"};for(var c in i){var l=i[c];a==c&&("bsImage"==a&&$(o).is("img")?t.dom.remove(o):$(o).hasClass(l)&&t.dom.remove(o))}}else t.insertContent(n);tinymce.activeEditor.dom.remove(tinymce.activeEditor.dom.select('br[data-mce-bogus="1"]'))}function i(t,e){var a="";if("bsBtn"==e){var n,s=$(t)[0].outerHTML.replace(" active",""),o="";$(t).find("span")[0]&&(o=$(t).find("span").attr("class").split(" ")[1]);var i=new Array("default","btn-primary","btn-success","btn-info","btn-warning","btn-danger"),r="";for(n=i.length-1;n>=0;n--)$(t).hasClass(i[n])&&(r=i[n]);var c=new Array("btn-xs","btn-sm","btn-lg"),l="";for(n=c.length-1;n>=0;n--)$(t).hasClass(c[n])&&(l=c[n]);var b=$(t).prop("tagName").toLowerCase(),p="";"a"==b&&(p=$(t).attr("href"));var d="";("button"==b||"input"==b)&&(d=$(t).attr("type"));var g;g="button"==b||"a"==b?$(t).remove("i").text():$(t).val();var m="prepend";if($(t).find("span")[0]){var u=new RegExp("/^"+g+"/");u.test($(t).html())===!0&&(m="append")}s=encodeURIComponent(s),o=encodeURIComponent(o),r=encodeURIComponent(r),l=encodeURIComponent(l),b=encodeURIComponent(b),p=encodeURIComponent(p),d=encodeURIComponent(d),g=encodeURIComponent(g),m=encodeURIComponent(m),a="btnCode="+s+"&btnIcon="+o+"&btnStyle="+r+"&btnSize="+l+"&btnTag="+b+"&btnHref="+p+"&btnType="+d+"&btnText="+g+"&iconPos="+m}else if("bsImage"==e){var h=$(t).attr("src"),f="",y="",C="",v="",B="false";$(t).hasClass("img-rounded")?v="img-rounded":$(t).hasClass("img-circle")?v="img-circle":$(t).hasClass("img-thumbnail")&&(v="img-thumbnail"),$(t).hasClass("img-responsive")&&(B="true"),$(t).attr("alt")&&(f=$(t).attr("alt")),$(t).attr("width")&&(y=$(t).attr("width")),$(t).attr("height")&&(C=$(t).attr("height")),h=encodeURIComponent(h),f=encodeURIComponent(f),y=encodeURIComponent(y),C=encodeURIComponent(C),v=encodeURIComponent(v),a="imgSrc="+h+"&imgAlt="+f+"&imgWidth="+y+"&imgHeight="+C+"&imgStyle="+v+"&imgResponsive="+B}else if("bsIcon"==e){var I=$(t).attr("class").split(" ")[1],w=$(t).css("font-size"),E=$(t).css("color");I=encodeURIComponent(I),w=encodeURIComponent(w),E=encodeURIComponent(E),a="glyphicon="+I+"&iconSize="+w+"&iconColor="+E}else if("bsTable"==e){t=$(t).closest(".table");var P="false",k="false",R="false",T="false",x="false";$(t).hasClass("table-striped")&&(P="true"),$(t).hasClass("table-bordered")&&(k="true"),$(t).hasClass("table-hover")&&(R="true"),$(t).hasClass("table-condensed")&&(T="true"),$(t).hasClass("table-responsive")&&(x="true"),a="tableStriped="+P+"&tableBordered="+k+"&tableHover="+R+"&tableCondensed="+T+"&tableResponsive="+x}else("bsBreadcrumb"==e||"bsPagination"==e||"bsPager"==e||"bsLabel"==e||"bsBadge"==e||"bsAlert"==e|"bsPanel"==e)&&(a="edit=true");return a}function r(t){var e=document.createElement("div");return e.innerHTML=t,0===e.childNodes.length?"":e.childNodes[0].nodeValue}function c(){tinymce.activeEditor.on("click keyup",function(t){var e="",a="";$(t.target).is("img")?(e="img",a="insertImageBtn"):$(t.target).attr("class")?$(t.target).attr("class").match(/btn/)?(e=".btn",a="insertBtnBtn"):$(t.target).attr("class").match(/glyphicon/)?(e=".glyphicon",a="insertIconBtn"):$(t.target).attr("class").match(/label/)?(e=".label",a="insertLabelBtn"):$(t.target).attr("class").match(/badge/)?(e=".badge",a="insertBadgeBtn"):$(t.target).attr("class").match(/alert/)&&(e=".alert",a="insertAlertBtn"):$(t.target).closest(".table").attr("class")?(e=".table",a="insertTableBtn"):$(t.target).closest(".breadcrumb").attr("class")?(e=".breadcrumb",a="insertBreadcrumbBtn"):$(t.target).closest(".pagination").attr("class")?(e=".pagination",a="insertPaginationBtn"):$(t.target).closest(".pager").attr("class")?(e=".pager",a="insertPagerBtn"):$(t.target).closest(".alert").attr("class")?(e=".alert",a="insertAlertBtn"):$(t.target).closest(".panel").attr("class")&&(e=".panel",a="insertPanelBtn"),b(),""!==e&&l(t.target,e,a)}),b()}function l(e,a,n){".glyphicon"==a?t.selection.setCursorLocation(e):".btn"==a&&t.selection.setCursorLocation(e,!0),".table"==a?($(e).closest(".table").addClass("active"),p(n,"on")):".breadcrumb"==a?($(e).closest(".breadcrumb").addClass("active"),p(n,"on")):".pagination"==a?($(e).closest(".pagination").addClass("active"),p(n,"on")):".pager"==a?($(e).closest(".pager").addClass("active"),p(n,"on")):".alert"==a?($(e).closest(".alert").addClass("active"),p(n,"on")):".panel"==a?($(e).closest(".panel").addClass("active"),p(n,"on")):($(e).addClass("active"),p(n,"on"))}function b(){for(var e=new Array(".btn",".glyphicon","img",".table",".breadcrumb",".pagination",".pager",".label",".badge",".alert",".panel"),a=0;a<e.length;a++)$(t.dom.select(e[a])).removeClass("active");p("allBtns","off")}function p(e,a){for(var n=t.buttons.bootstrap.items,s=n.length-1;s>=0;s--)("allBtns"==e||n[s]._name==e)&&("on"==a?n[s].addClass("active"):n[s].removeClass("active"))}var d=885,g=t.settings.extended_valid_elements;"undefined"==typeof g?g="span[class|style],a[accesskey|contextmenu|data-*|disabled|hidden|lang|style|media|download|id|rel|rev|charset|hreflang|tabindex|accesskey|type|name|href|target|title|class|onfocus|onblur]":g+=",span[class|style],a[accesskey|contextmenu|data-*|disabled|hidden|lang|style|media|download|id|rel|rev|charset|hreflang|tabindex|accesskey|type|name|href|target|title|class|onfocus|onblur]",tinyMCE.activeEditor.settings.extended_valid_elements=g,"undefined"==typeof t.settings.bootstrapConfig&&(t.settings.bootstrapConfig=[]),"undefined"==typeof t.settings.bootstrapConfig.bootstrapCssPath?(bootstrapCssPath=e+"/css/bootstrap.min.css",t.settings.bootstrapConfig.bootstrapCssPath={bootstrapCssPath:bootstrapCssPath}):bootstrapCssPath=t.settings.bootstrapConfig.bootstrapCssPath,"undefined"==typeof t.settings.bootstrapConfig.imagesPath?(imagesPath=e+"/",t.settings.bootstrapConfig.imagesPath={imagesPath:imagesPath}):imagesPath=t.settings.bootstrapConfig.imagesPath,"undefined"==typeof t.settings.bootstrapConfig.bootstrapElements&&(t.settings.bootstrapConfig.bootstrapElements={btn:!0,icon:!0,image:!0,table:!0,template:!0,breadcrumb:!0,pagination:!0,pager:!0,label:!0,badge:!0,alert:!0,panel:!0}),bootstrapElements=t.settings.bootstrapConfig.bootstrapElements;var m=t.settings.content_css;m="undefined"==typeof m?bootstrapCssPath+","+e+"/css/editor-content.min.css":m+","+bootstrapCssPath+","+e+"/css/editor-content.min.css",t.settings.content_css=m,t.on("init",function(){var a=e+"/css/editor.min.css";document.createStyleSheet?document.createStyleSheet(a):(cssLink=t.dom.create("link",{rel:"stylesheet",href:a}),document.getElementsByTagName("head")[0].appendChild(cssLink)),c()});var u=[],h=tinymce.ui.Factory.create({type:"button",text:"",classes:"widget btn bs-icon-btn",icon:"bootstrap-icon",tooltip:"Bootstrap Elements"});if(u.push(h),bootstrapElements.btn){var f=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-btn",name:"insertBtnBtn",tooltip:"Insert/Edit Bootstrap Button",onclick:function(){a("bootstrap-btn.php","Insert/Edit Bootstrap Button",580,"bsBtn")}});u.push(f)}if(bootstrapElements.image){var y=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-image",name:"insertImageBtn",tooltip:"Insert/Edit Bootstrap Image",onclick:function(){a("bootstrap-image.php","Insert/Edit Bootstrap Image",580,"bsImage")}});u.push(y)}if(bootstrapElements.icon){var C=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-icon",name:"insertIconBtn",tooltip:"Insert/Edit Bootstrap Icon",onclick:function(){a("bootstrap-icon.php","Insert/Edit Bootstrap Icon",450,"bsIcon")}});u.push(C)}if(bootstrapElements.table){var v=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-table",name:"insertTableBtn",tooltip:"Insert/Edit Bootstrap Table",onclick:function(){a("bootstrap-table.php","Insert/Edit Bootstrap Table",620,"bsTable")}});u.push(v)}if(bootstrapElements.template){var B=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-template",name:"insertTemplateBtn",tooltip:"Insert Bootstrap Template",onclick:function(){a("bootstrap-template.php","Insert Bootstrap Template",580,"bsTemplate")}});u.push(B)}if(bootstrapElements.breadcrumb){var I=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-breadcrumb",name:"insertBreadcrumbBtn",tooltip:"Insert/Edit Bootstrap Breadcrumb",onclick:function(){a("bootstrap-breadcrumb.php","Insert/Edit Bootstrap Breadcrumb",580,"bsBreadcrumb")}});u.push(I)}if(bootstrapElements.pagination){var w=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-pagination",name:"insertPaginationBtn",tooltip:"Insert/Edit Bootstrap Pagination",onclick:function(){a("bootstrap-pagination.php","Insert/Edit Bootstrap Pagination",650,"bsPagination")}});u.push(w)}if(bootstrapElements.pager){var E=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-pager",name:"insertPagerBtn",tooltip:"Insert/Edit Bootstrap Pager",onclick:function(){a("bootstrap-pager.php","Insert/Edit Bootstrap Pager",450,"bsPager")}});u.push(E)}if(bootstrapElements.label){var P=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-label",name:"insertLabelBtn",tooltip:"Insert/Edit Bootstrap Label",onclick:function(){a("bootstrap-label.php","Insert/Edit Bootstrap Label",350,"bsLabel")}});u.push(P)}if(bootstrapElements.badge){var k=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-badge",name:"insertBadgeBtn",tooltip:"Insert/Edit Bootstrap Badge",onclick:function(){a("bootstrap-badge.php","Insert/Edit Bootstrap Badge",350,"bsBadge")}});u.push(k)}if(bootstrapElements.alert){var R=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-alert",name:"insertAlertBtn",tooltip:"Insert/Edit Bootstrap Alert",onclick:function(){a("bootstrap-alert.php","Insert/Edit Bootstrap Alert",580,"bsAlert")}});u.push(R)}if(bootstrapElements.panel){var T=tinymce.ui.Factory.create({type:"button",classes:"widget btn bs-icon-btn",icon:"icon-panel",name:"insertPanelBtn",tooltip:"Insert/Edit Bootstrap Panel",onclick:function(){a("bootstrap-panel.php","Insert/Edit Bootstrap Panel",650,"bsPanel")}});u.push(T)}t.addButton("bootstrap",{type:"buttongroup",classes:"bs-btn",items:u})});